beetles <- read.table("http://statacumen.com/teach/SC1/SC1_11_beetles.dat", header = TRUE)
beetles$rep <- factor(beetles$rep)
library(caTools)
beetles
View(beetles)
linear_LS_model <- lm(y/n ~ conc)
linear_LS_model <- lm(beetles$y/beetles$n ~ beetles$conc)
linear_LS_model$fitted.values
p_fit <- linear_LS_model$fitted.values
plot(beetles$conc,beetles$y/beetles$n)
lines(beetles$conc,yfit)
lines(beetles$conc,p_fit)
beetles$rep
beetles
beetles$rep==1
beetles$beetles$rep==1
beetles[$beetles$rep==1]
beetles[beetles$rep==1]
linear_LS_model <- lm(beetles$y ~ beetles$conc + beetles$n )
linear_LS_model$fitted.values
p_fit <- linear_LS_model$fitted.values
y_fit <- linear_LS_model$fitted.values
plot(beetles$conc,y_fit/beetles$n)
p_fit <- y_fit/beetles$n
plot(beetles$conc,p_fit)
lines(beetles$conc,p_fit)
lines(beetles$conc,p_fit)
p_fit
linear_LS_model <- glm(beetles$y ~ beetles$conc, family=binomial, data = beetles )
linear_LS_model <- glm(beetles$ybeetles$n ~ beetles$conc, family=binomial, data = beetles )
linear_LS_model <- glm(beetles$y/beetles$n ~ beetles$conc, family=binomial, data = beetles )
linear_LS_model <- glm(beetles$y ~ beetles$conc, family=binomial, data = beetles )
linear_LS_model <- glm(beetles$y ~ beetles$n, family=binomial, data = beetles )
beetles
linear_LS_model <- glm(beetles$y/beetles$n ~ beetles$conc, family=binomial, data = beetles )
## Beetles data set
# conc = CS2 concentration
# y= number of beetles killed
# n= number of beetles exposed
# rep = Replicate number (1 or 2)
beetles <- read.table("http://statacumen.com/teach/SC1/SC1_11_beetles.dat", header = TRUE)
library(caTools)
beetles
beetles$rep <- factor(beetles$rep)
beetles
linear_LS_model <- lm(beetles$y/beetles$n ~ beetles$conc)
linear_LS_model$fitted.values
p_fit <- linear_LS_model$fitted.values
plot(beetles$conc,beetles$y/beetles$n)
lines(beetles$conc,p_fit)
legend(1,95,legend=c("Actual Values","Linear LS Predictor"))
## Beetles data set
# conc = CS2 concentration
# y= number of beetles killed
# n= number of beetles exposed
# rep = Replicate number (1 or 2)
beetles <- read.table("http://statacumen.com/teach/SC1/SC1_11_beetles.dat", header = TRUE)
beetles
linear_LS_model <- lm(beetles$y/beetles$n ~ beetles$conc)
linear_LS_model$fitted.values
p_fit <- linear_LS_model$fitted.values
plot(beetles$conc,beetles$y/beetles$n)
lines(beetles$conc,p_fit)
#USING QUADRATIC LEAST SQUARES
linear_LS_model <- lm(beetles$y/beetles$n ~ beetles$conc + beetles$conc**2)
linear_LS_model$fitted.values
p_fit <- linear_LS_model$fitted.values
plot(beetles$conc,beetles$y/beetles$n)
lines(beetles$conc,p_fit)
#USING QUADRATIC LEAST SQUARES
linear_LS_model <- lm(beetles$y/beetles$n ~ poly(beetles$conc,2))
quad_LS_model$fitted.values
#USING QUADRATIC LEAST SQUARES
quad_LS_model <- lm(beetles$y/beetles$n ~ poly(beetles$conc,2))
quad_LS_model$fitted.values
p_fit <- linear_LS_model$fitted.values
plot(beetles$conc,beetles$y/beetles$n)
lines(beetles$conc,p_fit)
beetles <- read.table("http://statacumen.com/teach/SC1/SC1_11_beetles.dat", header = TRUE)
beetles$rep <- factor(beetles$rep)
library(caTools)
beetles
#USING LINEAR LEAST SQUARES FOR FITTING
linear_LS_model <- lm(beetles$y/beetles$n ~ beetles$conc)
linear_LS_model$fitted.values
p_fit1 <- linear_LS_model$fitted.values
plot(beetles$conc,beetles$y/beetles$n)
lines(beetles$conc,p_fit)
lines(beetles$conc,p_fit1)
#USING QUADRATIC LEAST SQUARES
quad_LS_model <- lm(beetles$y/beetles$n ~ poly(beetles$conc,2))
quad_LS_model$fitted.values
p_fit2 <- linear_LS_model$fitted.values
plot(beetles$conc,beetles$y/beetles$n)
lines(beetles$conc,p_fit2)
p_fit2 <- quad_LS_model$fitted.values
plot(beetles$conc,beetles$y/beetles$n)
lines(beetles$conc,p_fit2)
## Beetles data set
# conc = CS2 concentration
# y= number of beetles killed
# n= number of beetles exposed
# rep = Replicate number (1 or 2)
beetles <- read.table("http://statacumen.com/teach/SC1/SC1_11_beetles.dat", header = TRUE)
beetles$rep <- factor(beetles$rep)
library(caTools)
beetles
#USING LINEAR LEAST SQUARES FOR FITTING
linear_LS_model <- lm(beetles$y/beetles$n ~ beetles$conc)
linear_LS_model$fitted.values
p_fit1 <- linear_LS_model$fitted.values
plot(beetles$conc,beetles$y/beetles$n)
lines(beetles$conc,p_fit1)
#USING QUADRATIC LEAST SQUARES
quad_LS_model <- lm(beetles$y/beetles$n ~ poly(beetles$conc,2))
quad_LS_model$fitted.values
p_fit2 <- quad_LS_model$fitted.values
plot(beetles$conc,beetles$y/beetles$n)
lines(beetles$conc,p_fit2)
lines(beetles$conc,p_fit1)
## Beetles data set
# conc = CS2 concentration
# y= number of beetles killed
# n= number of beetles exposed
# rep = Replicate number (1 or 2)
beetles <- read.table("http://statacumen.com/teach/SC1/SC1_11_beetles.dat", header = TRUE)
beetles$rep <- factor(beetles$rep)
library(caTools)
beetles
#USING QUADRATIC LEAST SQUARES
quad_LS_model <- lm(beetles$y/beetles$n ~ poly(beetles$conc,2))
quad_LS_model$fitted.values
p_fit2 <- quad_LS_model$fitted.values
plot(beetles$conc,beetles$y/beetles$n)
lines(beetles$conc,p_fit2)
#USING QUADRATIC LEAST SQUARES
quad_LS_model <- lm(beetles$y/beetles$n ~ poly(beetles$conc,2))
quad_LS_model$fitted.values
p_fit2 <- quad_LS_model$fitted.values
plot(beetles$conc,beetles$y/beetles$n)
lines(beetles$conc,p_fit2)
#USING LINEAR LEAST SQUARES FOR FITTING
linear_LS_model <- lm(beetles$y/beetles$n ~ beetles$conc)
linear_LS_model$fitted.values
p_fit1 <- linear_LS_model$fitted.values
plot(beetles$conc,beetles$y/beetles$n)
lines(beetles$conc,p_fit1)
## Beetles data set
# conc = CS2 concentration
# y= number of beetles killed
# n= number of beetles exposed
# rep = Replicate number (1 or 2)
beetles <- read.table("http://statacumen.com/teach/SC1/SC1_11_beetles.dat", header = TRUE)
beetles$rep <- factor(beetles$rep)
library(caTools)
beetles
#USING LINEAR LEAST SQUARES FOR FITTING
linear_LS_model <- lm(beetles$y/beetles$n ~ beetles$conc)
linear_LS_model$fitted.values
p_fit1 <- linear_LS_model$fitted.values
plot(beetles$conc,beetles$y/beetles$n)
lines(beetles$conc,p_fit1)
#USING QUADRATIC LEAST SQUARES
quad_LS_model <- lm(beetles$y/beetles$n ~ poly(beetles$conc,2))
quad_LS_model$fitted.values
p_fit2 <- quad_LS_model$fitted.values
plot(beetles$conc,beetles$y/beetles$n)
lines(beetles$conc,p_fit2)
f.lr.p <- function(X,beta)
{
# p = exp(X * beta)/(1+exp(X*beta)), pointwise division
X <- as.matrix(X)
beta <- as.vector(beta)
p <- exp(X%*%beta)/(1+exp(X%*%beta))
return (p)
}
#defining function to compute binomial log likelihood as a function of p, m, y
f.lr.l <- function(y,m,p)
{
y<-as.vector(y)
m<-as.vector(m)
p<-as.vector(p)
l<- t(y)%*%log(p)+t(m-y)%*%log(1-p)
}
l<-as.scalar(l)
y<-as.vector(y)
m<-as.vector(m)
p<-as.vector(p)
l<- t(y)%*%log(p)+t(m-y)%*%log(1-p)
return(l)
#defining function to compute binomial log likelihood as a function of p, m, y
f.lr.l <- function(y,m,p)
{
y<-as.vector(y)
m<-as.vector(m)
p<-as.vector(p)
l<- t(y)%*%log(p)+t(m-y)%*%log(1-p)
return(l)
}
# create data variables: m, y, X
n <- nrow(beetles)
m <- beetles$n
y <- beetles$y
X <- beetles$conc
n
m
y
X
#Fitting Quadratic Model
c(rep(1,n))
X<-matrix( c(rep(1,n), X, X^2), nrow=n )
X
X<-matrix( c(rep(1,n), X, X^2) )
X
X<-matrix( c(rep(1,n), X, X^2) , nrow=n )
X
# create data variables: m, y, X
n <- nrow(beetles)
m <- beetles$n
y <- beetles$y
X <- beetles$conc
n
m
y
X
#Fitting Quadratic Model
c(rep(1,n))
X<-matrix( c(rep(1,n), X, X^2) , nrow=n )
X
colnames(X) <- c("One","Conc","Conc^2")
X
r <- ncol(X) - 1
beta.1 <- c(log(sum(y) / sum(m - y)), rep(0, r))
beta.1
beta.1 <- c(log(sum(y) / sum(m - y)), rep(0, ncol(X) - 1))
beta.1
conc <- beetles$conc
glm_lr <- glm(formula = cbind(y,n-y)~conc + conc^2, family=binomial(link="logit"), data=beetles)
glm_lr$coefficients
glm_lr$fitted.values
glm_lr
glm_lr.fit
summary(glm_lr)
glm_lr <- glm(formula = cbind(y,n-y)~conc+conc^2, family=binomial(link="logit"), data=beetles)
summary(glm_lr)
glm_lr <- glm(formula = cbind(y,n-y)~conc+conc^2, family=binomial(link="logit"), data=X)
summary(glm_lr)
conc2<-conc^2
glm_lr <- glm(formula = cbind(y,n-y)~conc+conc2, family=binomial(link="logit"), data=X)
glm_lr <- glm(formula = cbind(y,n-y)~conc+conc2, family=binomial(link="logit"), data=beetles)
summary(glm_lr)
glm_lr$coefficients
glm_lr$fitted.values
glm_lr
p_hat <- glm_lr$fitted.values
plot(beetles$conc,beetles$y/beetles$n)
plot()
plot(beetles$conc,p)
plot(beetles$conc,p_hat)
plot(beetles$conc,p)
lines(beetles$conc,p_hat)
p_hat
beetles$conc
beetles <- read.table("http://statacumen.com/teach/SC1/SC1_11_beetles.dat", header = TRUE)
beetles$rep <- factor(beetles$rep)
glm_lr <- glm(formula = cbind(y,n-y)~conc+conc2, family=binomial(link="logit"), data=beetles)
# create data variables: m, y, X
n <- nrow(beetles)
m <- beetles$n
y <- beetles$y
conc <- beetles$conc
conc2<-conc^2
glm_lr <- glm(formula = cbind(y,n-y)~conc+conc2, family=binomial(link="logit"), data=beetles)
summary(glm_lr)
glm_lr$coefficients
glm_lr$fitted.values
glm_lr
p_hat <- glm_lr$fitted.values
p<-beetles$y/beetles$n
plot(beetles$conc,p)
lines(beetles$conc,p_hat)
p_hat
beetles$conc
abline(beetles$conc,p_hat)
p_hat <- glm_lr$fitted.values
p<-beetles$y/beetles$n
plot(beetles$conc,p)
abline(beetles$conc,p_hat)
abline(glm_lr)
line(beetles$conc,p_hat)
lines(beetles$conc,p_hat)
library(caTools)
library("car")
scatterplot(beetles$conc,p_hat)
plot(beetles$conc,p,legend=TRUE)
plot(beetles$conc,p_hat)
plot(beetles$conc,p,legend=TRUE)
p_hat
plot(beetles$conc,p_hat)
points(beetles$conc,p_hat)
plot(beetles$conc,p,legend=TRUE)
points(beetles$conc,p_hat)
lines(conc,p_hat)
## Beetles data set
# conc = CS2 concentration
# y= number of beetles killed
# n= number of beetles exposed
# rep = Replicate number (1 or 2)
beetles <- read.table("http://statacumen.com/teach/SC1/SC1_11_beetles.dat", header = TRUE)
View(beetles)
beetles <- beetles[-c(4)]
View(beetles)
library("caTools")
library("car")
beetles
#USING LINEAR LEAST SQUARES FOR FITTING
linear_LS_model <- lm(beetles$y/beetles$n ~ beetles$conc)
linear_LS_model$fitted.values
p_fit1 <- linear_LS_model$fitted.values
plot(beetles$conc,beetles$y/beetles$n)
lines(beetles$conc,p_fit1)
#USING QUADRATIC LEAST SQUARES
quad_LS_model <- lm(beetles$y/beetles$n ~ poly(beetles$conc,2))
# create data variables: m, y, X
n <- nrow(beetles)
m <- beetles$n
y <- beetles$y
conc <- beetles$conc
conc2<-conc^2
#USING LINEAR LEAST SQUARES FOR FITTING
linear_LS_model <- lm(beetles$y/beetles$n ~ beetles$conc)
linear_LS_model$fitted.values
p_fit1 <- linear_LS_model$fitted.values
plot(beetles$conc,beetles$y/beetles$n)
lines(beetles$conc,p_fit1)
#USING QUADRATIC LEAST SQUARES
quad_LS_model <- lm(beetles$y/beetles$n ~ conc+conc2)
quad_LS_model$fitted.values
p_fit2 <- quad_LS_model$fitted.values
plot(beetles$conc,beetles$y/beetles$n)
lines(beetles$conc,p_fit2)
## Beetles data set
# conc = CS2 concentration
# y= number of beetles killed
# n= number of beetles exposed
# rep = Replicate number (1 or 2)
beetles <- read.table("http://statacumen.com/teach/SC1/SC1_11_beetles.dat", header = TRUE)
library("caTools")
library("car")
beetles
# create data variables: m, y, X
n <- nrow(beetles)
m <- beetles$n
y <- beetles$y
conc <- beetles$conc
conc2<-conc^2
#USING LINEAR LEAST SQUARES FOR FITTING
linear_LS_model <- lm(beetles$y/beetles$n ~ beetles$conc)
linear_LS_model$fitted.values
p_fit1 <- linear_LS_model$fitted.values
plot(beetles$conc,beetles$y/beetles$n)
lines(beetles$conc,p_fit1)
#USING QUADRATIC LEAST SQUARES
quad_LS_model <- lm(beetles$y/beetles$n ~ conc+conc2)
quad_LS_model$fitted.values
p_fit2 <- quad_LS_model$fitted.values
plot(beetles$conc,beetles$y/beetles$n)
lines(beetles$conc,p_fit2)
glm_lr <- glm(formula = cbind(y,n-y)~conc+conc2, family=binomial(link="logit"), data=beetles)
glm_lr <- glm(formula = cbind(y,n-y)~conc+conc2, family=binomial(link="logit"), data=beetles)
summary(glm_lr)
glm_lr$coefficients
glm_lr$fitted.values
p_hat <- glm_lr$fitted.values
p<-beetles$y/beetles$n
plot(beetles$conc,p,legend=TRUE)
points(beetles$conc,p_hat)
lines(conc,p_hat)
p_hat
beetles$conc
## Beetles data set
# conc = CS2 concentration
# y= number of beetles killed
# n= number of beetles exposed
# rep = Replicate number (1 or 2)
beetles <- read.table("http://statacumen.com/teach/SC1/SC1_11_beetles.dat", header = TRUE)
library("caTools")
library("car")
beetles
# create data variables: m, y, X
n <- nrow(beetles)
m <- beetles$n
y <- beetles$y
conc <- beetles$conc
conc2<-conc^2
#USING LINEAR LEAST SQUARES FOR FITTING
linear_LS_model <- lm(beetles$y/beetles$n ~ beetles$conc)
linear_LS_model$fitted.values
p_fit1 <- linear_LS_model$fitted.values
plot(beetles$conc,beetles$y/beetles$n)
lines(beetles$conc,p_fit1)
#USING QUADRATIC LEAST SQUARES
quad_LS_model <- lm(beetles$y/beetles$n ~ conc+conc2)
quad_LS_model$fitted.values
p_fit2 <- quad_LS_model$fitted.values
plot(beetles$conc,beetles$y/beetles$n)
lines(beetles$conc,p_fit2)
glm_lr <- glm(formula = cbind(y,n-y)~conc+conc2, family=binomial(link="logit"), data=beetles)
summary(glm_lr)
glm_lr$coefficients
glm_lr$fitted.values
p_hat <- glm_lr$fitted.values
p<-beetles$y/beetles$n
plot(beetles$conc,p,legend=TRUE)
points(beetles$conc,p_hat)
lines(conc,p_hat)
p_hat
beetles$conc
beetles <- read.table("http://statacumen.com/teach/SC1/SC1_11_beetles.dat", header = TRUE)
beetles
beetles
summary
summary(glm_lr)
#USING LINEAR LEAST SQUARES FOR FITTING
linear_LS_model <- lm(beetles$y/beetles$n ~ beetles$conc)
linear_LS_model$fitted.values
p_fit1 <- linear_LS_model$fitted.values
plot(beetles$conc,beetles$y/beetles$n)
lines(beetles$conc,p_fit1)
plot(beetles$conc,beetles$y/beetles$n)
