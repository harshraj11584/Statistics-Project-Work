design = 0.125 * ones(1,2^3);

% p =[0.6300    0.2700    0.1000];
% theta = [2.7013    1.2000    0.7000    5.4000
%     2.7004    1.2000    0.7000    5.4000
%     5.0000    0.8000    0.7000    1.0000];

design = [0.0000    0.3395    0.3395    0.0000    0.3210    0.0000    0.0000    0.0000];
p = [0.0001    0.0002    0.0007    0.0029    0.0117    0.0469    0.1875    0.7500];


theta = [1.0000    1.0000    1.0000    1.0000
    1.5000    1.5000    1.5000    1.5000
    1.5000    1.5000    1.5000    1.5000
    1.5000    1.5000    1.5000    1.5000
    1.5000    1.5000    1.5000    1.5000
    1.5000    1.5000    1.5000    1.5000
    1.5000    1.5000    1.5000    1.5000
    1.5000    1.5000    1.5000    1.5000];


rho = 0.5;

l= size(p);
size(theta);
a = [];
for i = 1:l(2)
    a(i) = p(i)*trace_psi_p3(design,theta(i,:),rho);
end
sum(a)
