design = 1/16.0 * ones(1,2^4);


design = [0.0000    0.0000    0.0000    0.1392    0.0001    0.2138    0.3210    0.0000    0.3258    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000];

p = [0.0000    0.0000    0.0002    0.0000    0.0037    0.0586    0.9375];

theta = [1.0000    1.0000    1.0000    1.0000    1.0000    1.0000
    1.5000    1.5000    1.5000    1.5000    1.5000   -0.3310
    1.5000    1.5000    1.5000    1.5000    1.5000    0.3118
    1.5000    1.5000    1.5000    1.5000    1.5000   -0.4821
    1.5000    1.5000    1.5000    1.5000    1.5000    0.0828
    1.5000    1.5000    1.5000    1.5000    1.5000    0.1056
    1.5000    1.5000    1.5000    1.5000    1.5000    0.1012];


rho = 0.5;

l= size(p);
size(theta);
a = [];
for i = 1:l(2)
    a(i) = p(i)*trace_psi_p4(design,theta(i,:),rho);
end
sum(a)
