% design = 0.125 * ones(1,2^3);

% p =[0.6300    0.2700    0.1000];
% theta = [2.7013    1.2000    0.7000    5.4000
%     2.7004    1.2000    0.7000    5.4000
%     5.0000    0.8000    0.7000    1.0000];

design = [0.0003    0.0469    0.2592    0.3549    0.3387    0.0000    0.0000    0.0000];
p = [0.0000    0.0000    0.0000    0.0001    0.0002    0.0008    0.0004    0.0043    0.0019    0.0077    0.0051    0.0205    0.0137    0.0547    0.0156    0.8750];



theta = [1.0000    1.0000    1.0000    1.0000    1.0000
    1.5000    1.5000    1.5000    1.5000   -0.3712
    1.5000    1.5000    1.5000    1.5000    0.0154
    1.5000    1.5000    1.5000    1.5000    0.0681
    1.5000    1.5000    1.5000    1.5000   -0.1465
    1.5000    1.5000    1.5000    1.5000    0.2154
    1.5000    1.5000    1.5000    1.5000   -0.1637
    1.5000    1.5000    1.5000    1.5000    0.0320
    1.5000    1.5000    1.5000    1.5000   -0.1060
    1.5000    1.5000    1.5000    1.5000    0.0434
    1.5000    1.5000    1.5000    1.5000   -0.0661
    1.5000    1.5000    1.5000    1.5000    0.0263
    1.5000    1.5000    1.5000    1.5000   -0.0597
    1.5000    1.5000    1.5000    1.5000    0.0286
    1.5000    1.5000    1.5000    1.5000   -0.0756
    1.5000    1.5000    1.5000    1.5000    0.0010];


rho = 0.5;

l= size(p);
size(theta);
a = [];
for i = 1:l(2)
    a(i) = p(i)*trace_psi_p3(design,theta(i,:),rho);
end
sum(a)
